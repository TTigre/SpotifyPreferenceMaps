var globalTriggeringElement,globalAdditionalFunction=function(){},getDateFromISOWeek=function(a,b){try{var c=a.split(b),d=c[0],e=c[1],f=new Date(d,0,1+7*(e-1)),g=f.getDay(),h=f;return g<=4?h.setDate(f.getDate()-f.getDay()+1):h.setDate(f.getDate()+8-f.getDay()),h}catch(a){return console.error("Cannot convert Week into date"),new Date}},showWeekCalendar=function(a,b){globalTriggeringElement=a,globalAdditionalFunction=b;var c=$(a).prev(),d=c.val();c.datepicker("option","defaultDate",getDateFromISOWeek(d,"-")),c.val(d),c.datepicker("show")},setWeekCalendar=function(a){var b,c,d=function(){window.setTimeout(function(){var a=$("#ui-datepicker-div .ui-state-active"),b=a.parent(),c=b.parent();c.find("a").addClass("ui-state-active")},1)};$(a).datepicker({showOtherMonths:!0,selectOtherMonths:!0,showWeek:!0,firstDay:1,onSelect:function(a,e){var f=$(this).datepicker("getDate"),g=new Date(f.getFullYear(),f.getMonth(),f.getDate()),h=$.datepicker.iso8601Week(g);h<10&&(h="0"+h);var i=f.getFullYear()+"-"+h;$(this).val(i),$(this).prev().html(i),b=new Date(f.getFullYear(),f.getMonth(),f.getDate()-f.getDay()),c=new Date(f.getFullYear(),f.getMonth(),f.getDate()-f.getDay()+6),d(),$(this).data("datepicker").inline=!0,globalAdditionalFunction(globalTriggeringElement)},onClose:function(){$(this).data("datepicker").inline=!1},beforeShow:function(){d()},beforeShowDay:function(a){var e="";return a>=b&&a<=c&&(e="ui-datepicker-current-day"),d(),[!0,e]},onChangeMonthYear:function(a,b,c){d()}}).datepicker("widget").addClass("ui-weekpicker"),$("body").on("mousemove",".ui-weekpicker .ui-datepicker-calendar tr",function(){$(this).find("td a").addClass("ui-state-hover")}),$("body").on("mouseleave",".ui-weekpicker .ui-datepicker-calendar tr",function(){$(this).find("td a").removeClass("ui-state-hover")})},convertToWeekPicker=function(a,b){if("INPUT"!=a.prop("tagName")||"text"!=a.attr("type")&&"hidden"!=a.attr("type"))a.replaceWith("<span>ERROR: please control js console</span>"),console.error('convertToWeekPicker() - ERROR: The target element is not compatible with this conversion, try to use an <input type="text" /> or an <input type="hidden" />');else{var c=a.val();$('<span class="displayDate" style="display:none">'+c+"</span>").insertBefore(a),b&&$('<i class="fa fa-'+b+' showCalendar" aria-hidden="true" style="cursor:pointer;margin-left: 10px;margin-top: 3px;" onclick="javascript:showWeekCalendar(this)"></i>').insertAfter(a),setWeekCalendar(a)}};